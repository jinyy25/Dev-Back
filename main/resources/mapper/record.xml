<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<!-- mapper 인터페이스가 위치하는 경로 -->
<mapper namespace="kr.vtw.kms.record.mapper.RecordMapper">

    <!-- id: mapper 인터페이스에서 선언한 메서드 이름과 같아야 한다. resultType: VO 클래스가 위치하는 경로 -->
    <select id="recordView" parameterType="RecordDto" resultType="RecordDto">
        SELECT file_code
			, save_name
       		, save_thumbname
       		, title_file
			, date_format(indt,'%Y-%m-%d') indt
        	, desc_file
       	FROM deepir.tb_file_user
       	WHERE 1=1
       	AND type_code = 2
		AND title_file like  CONCAT('%', #{titleFile}, '%')
		ORDER BY file_code desc
    </select>

	<select id="recordDetail" parameterType="RecordDto" resultType="RecordDto">
        SELECT file_code
			, save_name
       		, save_thumbname
       		, title_file
			, date_format(indt,'%Y-%m-%d') indt
        	, desc_file
			, type_file
       	FROM deepir.tb_file_user
       	WHERE 1=1
       	AND type_code = 2
		AND file_code = #{fileCode}
    </select>

	<delete id="recordDelete" parameterType="RecordDto">
	    DELETE FROM deepir.tb_file_user
	    WHERE 1=1
	    AND file_code = #{fileCode}
	</delete>


	<update id="recordUpdate" parameterType="RecordDto">
		UPDATE deepir.tb_file_user
				SET updt=now()
				, title_file	= #{titleFile}
				, desc_file		= #{descFile}
				WHERE 1=1
				AND file_code 	= #{fileCode}
	</update>

</mapper>